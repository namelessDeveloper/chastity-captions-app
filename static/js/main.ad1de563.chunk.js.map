{"version":3,"sources":["contexts/index.ts","lib/index.ts","hooks/index.ts","components/PointTracker/PointTracker.tsx","style/index.ts","components/Item/styles.ts","components/Item/components/Image.tsx","components/Item/components/Text.tsx","components/Item/components/Title.tsx","components/Item/Item.tsx","components/Section/Section.tsx","containers/Cyoa/Cyoa.tsx","App.tsx","index.tsx"],"names":["PointContext","createContext","PointProvider","Provider","gist","filename","a","fetch","data","json","console","log","JSON","parse","files","content","useCyoa","useState","config","setConfig","pathname","useLocation","useEffect","substr","split","gistID","getConfig","then","title","Tracker","styled","div","Negative","span","PointTracker","points","available","total","theme","unaffordable","css","ItemWrapper","p","affordable","direction","width","toggled","toggleColor","Image","src","style","height","styleCost","cost","minContent","Wrapper","noHeader","H4","h4","P","Text","body","header","undefined","dangerouslySetInnerHTML","__html","StyledTitle","color","Title","text","Item","onClick","setToggled","parts","map","part","key","type","SectionWrapper","flexDirection","Section","setPoints","useContext","setAvailable","setTotal","usePoints","handleClick","items","item","Cyoa","sections","sect","App","input","useRef","history","useHistory","className","value","htmlFor","ref","placeholder","push","current","GlobalStyle","createGlobalStyle","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.ad1de563.chunk.js","sourcesContent":["import { createContext } from \"react\";\n\n\ninterface ContextProps {\n  available: number\n  setAvailable: (points: number) => void\n  \n  total: number\n  setTotal: (points: number) => void\n}\n\nexport const PointContext = createContext<Partial<ContextProps>>({})\n\nexport const PointProvider = PointContext.Provider\n","export async function getConfig(gist:string, filename?:string){\n  try {\n    const data = await fetch(`https://api.github.com/gists/${gist}`)\n    const json = await data.json()    \n    console.log(json);\n    \n    return JSON.parse(json.files[filename || \"cyoa.json\"].content)\n  } catch (error) {\n    return null\n  }\n}","import { useState, useEffect } from \"react\"\nimport { useLocation } from \"react-router-dom\"\nimport { getConfig } from \"../lib\"\nimport { Config } from \"../types\"\n\nexport function useCyoa(){\n  const [config, setConfig] = useState<null | Config>(null)\n  const {pathname} = useLocation()  \n  useEffect(() => {\n    // Path will be e.g. /cyoa-viewer/f728c844cd509bd87b5edaff8c15be2b\n    const [gistID, filename] = pathname.substr(1).split('/')\n    if(gistID){\n      getConfig(gistID, filename)\n        .then(json => {\n          if(json){\n            //@ts-ignore\n            setConfig(json)\n            console.log(`Loaded \"${json?.title}\"`)\n          }\n        })\n    } else {\n      setConfig(null)\n    }\n  }, [pathname])\n  return config\n}\n\n\nexport * from './useDevCyoa'","import styled from \"styled-components\"\n\nconst Tracker = styled.div`\n  top: 0;\n  position: sticky;\n  width: 100vw;\n  background-color: black;\n  padding: 1em;\n  border-bottom: 3px solid white;\n`\n\nconst Negative = styled.span`\n  color: red;\n`\n\nfunction formatAvailable(points: number){\n  return points >= 0 ? points : <Negative>{points}</Negative>\n}\n\ninterface Props {\n  available: number\n  total: number\n}\n\nexport const PointTracker: React.FC<Props> = ({\n  available,\n  total,\n}) => {\n  return (\n    <Tracker>Available Points: {formatAvailable(available)}</Tracker>\n  )\n}","export const theme = {\n  plus: \"#44ca44\",\n  minus: \"red\",\n}","import styled, { css } from \"styled-components\"\nimport { Direction } from \"../../types\"\n\nconst unaffordable = css`\n  pointer-events: none;\n  & ::before {\n    background: black;\n    mix-blend-mode: saturation;\n  }\n`\n\ninterface ItemWrapperProps {\n  direction: string\n  width?: number\n  toggled: boolean\n  toggleColor: string\n  affordable: boolean\n}\n\nexport const ItemWrapper = styled.div<ItemWrapperProps>`\n  ${p => p.affordable ? \"\" : unaffordable}\n  display:flex;\n  flex-direction: ${p => p.direction};\n  // TODO min-width\n  min-width: ${p => p.width && p.width}px;\n  border: 5px solid ${p => p.toggled ? p.toggleColor : \"black\"};\n  border-radius: 1em;\n  & img {\n    border-top-left-radius: 0.5em;\n    border-top-right-radius: 0.5em;\n  }\n  padding: 1em;\n  cursor: pointer;\n  user-select: none;\n`","export const Image: React.FC<{src:string, width?:number}> = ({src, width = 200}) => {\n\n  return (\n    <img src={src} style={{width:`${width}px`, height: \"auto\"}} />\n  )\n}","import styled, { css } from \"styled-components\"\nimport { theme } from \"../../../style\"\n\nfunction styleCost(cost?: number){\n  if(cost){\n    if(cost > 0) return `<span style=\"color:${theme.plus}\">${cost}</span>`\n    if(cost < 0) return `<span style=\"color:${theme.minus}\">${cost}</span>`\n  }\n  return cost\n}\n\nconst minContent = css`\n  width: min-content;\n`\n\nconst Wrapper = styled.div<{noHeader: boolean}>`\n  ${p => p.noHeader ? \"\" : minContent}\n`\nconst H4 = styled.h4`\n  white-space: nowrap;\n`\nconst P = styled.p`\n`\n\nexport const Text: React.FC<{body?: string, header?: string, cost?: number}> = ({\n  body,\n  header,\n  cost,\n}) => {\n\n  \n  return (\n    <Wrapper noHeader={header == undefined}>\n      {header && <H4 dangerouslySetInnerHTML={{__html: `${header} [${styleCost(cost)}]`}}/>}\n      {body && <P dangerouslySetInnerHTML={{__html: body}}/>}\n    </Wrapper>\n  )\n}","import styled from \"styled-components\"\n\ninterface StyledProps {\n  color?: string\n}\n\nconst StyledTitle = styled.div<StyledProps>`\n  background-color: ${p => p.color || \"#a80eb6\"};\n  color: White;\n  font-weight: 700;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0 1em;\n  border: 3px solid white;\n  border-radius: .5em;\n`\n\ninterface TitleProps extends StyledProps{\n  text:string\n  cost?: number\n}\n\nexport const Title: React.FC<TitleProps> = ({\n  text, color\n}) => {\n\n  return (\n    <StyledTitle color={color}>{text}</StyledTitle>\n  )\n}","import React, { useState } from \"react\"\nimport { theme } from \"../../style\"\nimport { Direction, Item as ItemInterface } from \"../../types\"\nimport { ItemWrapper } from \"./styles\"\n\nimport {\n  Image, Text, Title\n} from './components'\n\ninterface Props {\n  data:ItemInterface,\n  onClick?:(cost:number)=>void,\n}\n\nexport const Item: React.FC<Props> = ({\n  data,\n  onClick,\n}) => {\n\n  const [toggled, setToggled] = useState(false)\n\n  function handleClick(){\n    if(data.cost && onClick){\n      if(!toggled){\n        onClick(data.cost)\n        setToggled(true)\n      } else {\n        onClick(-data.cost)\n        setToggled(false)\n      }\n    }\n  }\n\n  return (\n    <ItemWrapper\n      toggled={toggled}\n      toggleColor={data.cost && data.cost > 0 ? theme.plus : theme.minus}\n      onClick={handleClick}\n      direction={data.direction || \"row\"}\n      width={data.width}\n      affordable={true} // TODO context points\n    >\n\n      {data.parts.map((part, key) => {\n        switch (part.type) {\n          case \"image\": return <Image key={key} src={part.src} width={part.width}/>    \n          case \"text\": return <Text key={key} cost={data.cost} body={part.body} header={part.header}/>\n          case \"title\": return <Title key={key} cost={data.cost} text={part.text} />\n          default: return null\n        }\n      })}\n    </ItemWrapper>\n  )\n}","import React, { useContext } from \"react\"\nimport styled, { css } from \"styled-components\"\nimport { Direction, Section as SectionType } from \"../../types\"\n\nimport {Item} from '../'\nimport { PointContext } from \"../../contexts\"\n\nfunction flexDirection(direction?: Direction){\n  if(direction){\n    return css`flex-direction: ${direction};`\n  }\n}\n\nconst SectionWrapper = styled.div<{direction?: Direction}>`\n  display:flex;\n  ${p => flexDirection(p.direction)}\n  flex-wrap: wrap;\n`\n\ninterface Props {\n  data:SectionType\n}\n\nfunction usePoints(){\n  const {setAvailable, setTotal, total, available} = useContext(PointContext)\n\n  return function setPoints(cost:number){\n    console.log(cost);\n    if(available != undefined && setAvailable){\n      setAvailable(available + cost)\n    }\n  }\n}\n\n\nexport const Section: React.FC<Props> = ({data}) => {\n\n  const setPoints = usePoints()\n\n  const handleClick = data.type !== \"none\" \n    ? (cost:number) => setPoints(cost)\n    : undefined\n\n  if(data.type == \"multiple\"){\n    return (\n      <SectionWrapper direction={data.direction}>\n        {data.items.map((item, key) => \n          <Item key={key} data={item} onClick={handleClick}/>\n        )}\n      </SectionWrapper>\n    )\n  }\n\n  if(data.type == \"single\"){\n    return (\n      <SectionWrapper direction={data.direction}>\n        {data.items.map((item, key) => \n          <Item key={key} data={item} onClick={handleClick}/>\n        )}\n      </SectionWrapper>\n    )\n  }\n\n  return (\n    <SectionWrapper direction={data.direction}>\n      {data.items.map((item, key) => \n        <Item key={key} data={item}/>\n      )}\n    </SectionWrapper>\n  )\n}","import React, { useContext } from \"react\"\nimport { PointTracker } from \"../../components/PointTracker\"\nimport { Config } from \"../../types\"\nimport {Section} from '../../components'\nimport { PointContext } from \"../../contexts\"\n\ninterface Props {\n  config: Config\n}\n\nexport const Cyoa: React.FC<Props> = ({\n  config,\n}) => {\n  const {\n    available = 0,\n    total = 0,\n    setAvailable,\n    setTotal,\n  } = useContext(PointContext)\n\n  return (\n    <>\n      <PointTracker available={available} total={total}/>\n      {config.sections.map((sect, key) => \n        //@ts-ignore\n        <Section data={sect} key={key}/>\n      )}\n    </>\n  )\n}","import {\n  Config,\n  selectionType,\n} from './types';\n\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { useEffect, useRef, useState } from 'react';\nimport { PointProvider } from './contexts';\nimport { useCyoa, useDevCyoa } from './hooks';\nimport { PointTracker } from './components/PointTracker';\nimport { Cyoa } from './containers/Cyoa';\n\nfunction App() {\n  const config = useCyoa()\n  // const config = jsonConfig\n  const input = useRef<HTMLInputElement>(null)\n  const history = useHistory()\n  useDevCyoa(input)\n\n  const [available, setAvailable] = useState(0)\n  const [total, setTotal] = useState(0)\n\n  if(config !== null && config.type == \"cyoa\"){\n    return (\n      <div className=\"App\">\n        <PointProvider value={{\n          available,\n          setAvailable,\n          total, \n          setTotal,\n        }}>\n          <Cyoa config={config} />\n        </PointProvider>\n      </div>\n    );\n  }\n\n\n\n  return (\n    <div className=\"App\">\n      <label htmlFor=\"\">Load a config from a github gist:</label>\n      <input ref={input} type=\"text\" placeholder=\"gistID\"/>\n      <button onClick={() => history.push(input.current?.value || \"\")}>Load</button>\n    </div>\n  )\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nimport {HashRouter} from 'react-router-dom'\nimport { createGlobalStyle } from 'styled-components';\n\nconst GlobalStyle = createGlobalStyle`\n  body {\n    background:  black;\n    color: white;\n    font-family: sans-serif;\n  }\n`\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <GlobalStyle/>\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}